<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="Hexo 主题制作"><meta name="keywords" content="Hexo"><meta name="author" content="Yin-Hongwei"><meta name="copyright" content="Yin-Hongwei"><title>Hexo 主题制作 | Hongwei Blog</title><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.10.0/js/md5.min.js"></script></head><body><header id="page-header"><nav id="navbar"><span class="nav-left"><div class="tou-img"><img src="/img/tou.jpg"></div><a id="site-name" href="/">Hongwei Blog</a></span><i class="fa fa-bars toggle-menu nav-right" aria-hidden="true"></i><span class="nav-right menus"><a class="site-page" href="/about">关于</a><a class="site-page" href="/archives">存档</a><a class="site-page" href="/tags">标签</a></span></nav></header><article id="content-outer"><section id="content-inner"><article class="article-entry" id="post"><h1>Hexo 主题制作</h1><h2 id="一、前言"><a href="#一、前言" class="headerlink" title="一、前言"></a>一、前言</h2><p>之前的主题用的是默认的，网上也下载使用过别人写的主题，但是终究还是想用自己写的。所以就写了这个主题——<a href="https://github.com/Yin-Hongwei/hexo-theme-Yin" target="_blank" rel="noopener">Yin</a>。</p>
<a id="more"></a>
<p>制作一个 hexo 主题需要提前了解一些知识：</p>
<ul>
<li><p>模板引擎：我使用的模板引擎是 <a href="https://pugjs.org/api/getting-started.html" target="_blank" rel="noopener">pug</a>，好处是代码的复用。</p>
</li>
<li><p>CSS预处理：我使用的 CSS 预处理器是 <a href="http://stylus-lang.com/" target="_blank" rel="noopener">Stylus</a>，好处也是代码的复用。</p>
</li>
<li><p>Hexo 文档：主要了解 <a href="https://hexo.io/docs/" target="_blank" rel="noopener">hexo</a> 相关配置。</p>
</li>
</ul>
<h2 id="二、项目创建"><a href="#二、项目创建" class="headerlink" title="二、项目创建"></a>二、项目创建</h2><p>创建项目可以用命令行直接生成脚手架，也可以自己一个文件一个文件的写。</p>
<p>在 themes 目录中创建一个文件夹并起个名字，在主题的 _config.yml 中，找到 <code>theme: landsacpe</code> 的字样并替换成成你项目的名字。然后手动创建<code>layout</code>， <code>source</code> 文件夹。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── layout <span class="comment"># 页面模板文件</span></span><br><span class="line">└── <span class="built_in">source</span> <span class="comment"># 主题资源文件，包括页面样式，脚本，字体等</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>说明：写模板之前需要知道要写什么东西，其实说白了就是 layout 中写写 html，source 中写写 css。你需要知道你要写哪些页面，比如主页，关于，存档，标签，还有详情页，而这些页有很多地方也相似，比如头部，底部，还有 html head标签中的内容，这些不需要每个文件中都写一遍，可以把相同的地方统一写出来，然后去那些页里导入。总之，写的时候要有模块化的思想。</p>
</blockquote>
<p>在 <code>layout</code> 中创建 <code>index.pug</code> 文件，这是主页。在同级的 includes 中创建 layout.pug 文件，这个是所有页面都要继承的部分。里面不要臃肿的写一堆代码，划分好模块，交给其他模块去处理，这样后期也好维护。比如这里的 head、header、footer。</p>
<p><img src="https://tva1.sinaimg.cn/large/00831rSTly1gdaoh2wd4jj31cq0o4790.jpg" alt=""></p>
<p>在  <code>index.pug</code>  中导入模块</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">extends includes/layout.pug</span><br></pre></td></tr></table></figure>
<p>运行 hexo s，去这里 <a href="http://localhost:4000/" target="_blank" rel="noopener">http://localhost:4000/</a> 预览。</p>
<p>之后边写也要去 source 目录下写写样式。CSS 预处理处理能代码复用，对于全局样式的控制也是非常方便。</p>
<h2 id="三、页面数据来源"><a href="#三、页面数据来源" class="headerlink" title="三、页面数据来源"></a>三、页面数据来源</h2><h3 id="1、站点的配置文件-config-yml"><a href="#1、站点的配置文件-config-yml" class="headerlink" title="1、站点的配置文件_config.yml"></a>1、站点的配置文件_config.yml</h3><h3 id="2、Hexo预置（变量、辅助函数）"><a href="#2、Hexo预置（变量、辅助函数）" class="headerlink" title="2、Hexo预置（变量、辅助函数）"></a>2、Hexo预置（<a href="https://hexo.io/docs/variables.html" target="_blank" rel="noopener">变量</a>、<a href="https://hexo.io/docs/helpers.html" target="_blank" rel="noopener">辅助函数</a>）</h3><p>Hexo预置的变量主要有<code>site</code>、<code>page</code>、<code>post</code>和<code>theme</code>。</p>
<ul>
<li><code>site</code>变量：可以获取站点的文章总数，标签总数和分类总数。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">site = &#123;</span><br><span class="line">  posts: [object object], // 包含文章对象的数组</span><br><span class="line">  pages: [object object], // 包含页面对象的数组</span><br><span class="line">  categories: [object object], // 包含分类对象的数组</span><br><span class="line">  tags: [object object] // 包含标签对象的数组</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p><code>page</code>变量：代表当前页所有文章的相关信息。</p>
</li>
<li><p><code>post</code>变量：代表某一篇文章的具体信息。<code>post</code>变量比 <code>page</code>变量多了这一篇文章的<code>tags</code>、<code>categories</code>和<code>published</code>变量。</p>
</li>
<li><p><code>theme</code>变量：代表主题的配置。</p>
</li>
</ul>
<p>Hexo预置的辅助函数，常用的我觉得有如下几个：</p>
<p>1）<code>is_home</code>、<code>is_post</code>、<code>is_tag</code>、<code>is_category</code>、<code>is_post</code>等几个判断当前文章类型的函数</p>
<p>2）<code>date</code>、<code>time</code>等时间字符串处理函数</p>
<p>3）<code>list_categories</code>、<code>list_tags</code>、<code>tagcloud</code>等生成分类列表、标签列表、标签云等函数</p>
<p>4）<code>toc</code> 生成文章目录</p>
<p>5）<code>paginator</code> 生成页面页码</p>
<h3 id="3、主题的配置文件-config-yml"><a href="#3、主题的配置文件-config-yml" class="headerlink" title="3、主题的配置文件_config.yml"></a>3、主题的配置文件_config.yml</h3><h2 id="四、实现"><a href="#四、实现" class="headerlink" title="四、实现"></a>四、实现</h2><p>前面提到 layout.pug 是很多页面都要复用的一个模块，他里面的很多结构也是拆开来写。</p>
<h3 id="1、layout-pug-模块制作"><a href="#1、layout-pug-模块制作" class="headerlink" title="1、layout.pug 模块制作"></a>1、layout.pug 模块制作</h3><p>1）博客头部制作</p>
<p>博客头部在 header.pug 文件中，会作为模块导入到 layout.pug 文件中。这里的实现比较简单，主要利用了 <a href="https://hexo.io/zh-cn/docs/helpers" target="_blank" rel="noopener">url_for()</a> 辅助函数将相对路径转为页面的绝对路径。theme.menu 会去读你主题的配置文件_config.yml 中导航菜单的设置。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">header#header</span><br><span class="line">  nav#navbar</span><br><span class="line">    span.nav-left</span><br><span class="line">      div.tou-img</span><br><span class="line">        img(src=<span class="string">"/img/tou.jpg"</span>)</span><br><span class="line">      a#site-name(href=url_for('/')) #[=config.title]</span><br><span class="line">    i.fa.fa-bars.toggle-menu.nav-right(aria-hidden=<span class="string">"true"</span>)</span><br><span class="line"></span><br><span class="line">    span.nav-right.menus</span><br><span class="line">      each url, label <span class="keyword">in</span> theme.menu</span><br><span class="line">        a.site-page(href=url)= label</span><br></pre></td></tr></table></figure>
<p>2）博客中间内容部分制作</p>
<p>因为中间内容部分那个页面都不一样，所以这里中间部分不会写死。</p>
<p>3）博客尾部制作</p>
<p>尾部主要写一些声明。</p>
<p>layout.pug 文件制作完就能开始着手页面的制作了。</p>
<h3 id="2、主页制作"><a href="#2、主页制作" class="headerlink" title="2、主页制作"></a>2、主页制作</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">extends includes/layout.pug</span><br><span class="line"></span><br><span class="line">block content</span><br><span class="line">  include includes/recent-posts.pug</span><br><span class="line">  include includes/partial/pagination.pug</span><br></pre></td></tr></table></figure>
<p>主页的制作是在 layout.pug 文件 的基础上去实现，主要要实现文章和页码两部分。文章信息的获取要用到 hexo 为我们提供的<a href="https://hexo.io/zh-cn/docs/variables" target="_blank" rel="noopener">变量</a>，这里的制作主要就是在调 page 上的变量。</p>
<p>页码的制作利用 <a href="https://hexo.io/zh-cn/docs/helpers" target="_blank" rel="noopener">paginator函数</a>去实现</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">-</span><br><span class="line">  <span class="keyword">var</span> options = &#123;</span><br><span class="line">    prev_text: <span class="string">'&lt;i class="fa fa-chevron-left"&gt;&lt;/i&gt;'</span>,</span><br><span class="line">    next_text: <span class="string">'&lt;i class="fa fa-chevron-right"&gt;&lt;/i&gt;'</span>,</span><br><span class="line">    mid_size: <span class="number">1</span></span><br><span class="line">  &#125;</span><br><span class="line">nav#pagination</span><br><span class="line">  <span class="keyword">if</span>(!is_post())</span><br><span class="line">    .pagination</span><br><span class="line">      !=paginator(options)</span><br></pre></td></tr></table></figure>
<h3 id="3、文章详情页制作"><a href="#3、文章详情页制作" class="headerlink" title="3、文章详情页制作"></a>3、文章详情页制作</h3><p>文章详情页是 post.pug 文件，这里的制作主要是些样式让页面变得好看一些。其次就是一些扩展的功能。</p>
<h4 id="1）微信打赏"><a href="#1）微信打赏" class="headerlink" title="1）微信打赏"></a>1）微信打赏</h4><p>在站点的配置文件 _config.yml 中对是否开启该功能和打赏的图片做设置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">reward:</span><br><span class="line">  enable: true</span><br><span class="line">  alipay: /img/weixin.jpg</span><br></pre></td></tr></table></figure>
<p>然后在文章详情页（post.pug）中进行引用。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (theme.reward.enable)</span><br><span class="line">    .qr-code</span><br><span class="line">    img.qrcode-img(src=(theme.reward.alipay))</span><br><span class="line">    .qrcode-desc=<span class="string">'微信打赏'</span></span><br></pre></td></tr></table></figure>
<h4 id="2）页码"><a href="#2）页码" class="headerlink" title="2）页码"></a>2）页码</h4><p>这里的页码和主页的页码有些区别，这里只需要能切换上上一篇和下一篇文章即可。所以在去之前页码的模块中兼容一下。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(page.prev)</span><br><span class="line"> .prev-post.pull-left</span><br><span class="line">    a(href=url_for(page.prev.path))</span><br><span class="line">      i.fa.fa-chevron-left</span><br><span class="line">      span=page.prev.title</span><br><span class="line"><span class="keyword">if</span>(page.next)</span><br><span class="line">  .next-post.pull-right</span><br><span class="line">    a(href=url_for(page.next.path))</span><br><span class="line">      span=page.next.title</span><br><span class="line">      i.fa.fa-chevron-right</span><br></pre></td></tr></table></figure>
<h4 id="3）评论功能"><a href="#3）评论功能" class="headerlink" title="3）评论功能"></a>3）评论功能</h4><p>这里的制作需要借助第三方插件进行制作，这里提供两种选择，这里提供一下我站点的配置文件 _config.yml 中的配置，至于代码中的引用直接去 commonts 目录下看代码即可。</p>
<ul>
<li>gitalk：<a href="https://gitalk.github.io/（去" target="_blank" rel="noopener">https://gitalk.github.io/（去</a> github 上配置，获取 client_id、client_secret）</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># gitalk </span><br><span class="line">gitalk:</span><br><span class="line">  enable: true</span><br><span class="line">  id: &apos;&apos;</span><br><span class="line">  owner: 。。。</span><br><span class="line">  admin: 。。。</span><br><span class="line">  repo: 。。。</span><br><span class="line">  client_id: 。。。</span><br><span class="line">  client_secret: 。。。</span><br></pre></td></tr></table></figure>
<ul>
<li>disqus：<a href="https://disqus.com/（去官网注册）" target="_blank" rel="noopener">https://disqus.com/（去官网注册）</a></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># Disqus </span><br><span class="line">disqus:</span><br><span class="line">  enable: false</span><br><span class="line">  shortname: 。。。</span><br><span class="line">  count: true</span><br></pre></td></tr></table></figure>
<h3 id="4、关于页制作"><a href="#4、关于页制作" class="headerlink" title="4、关于页制作"></a>4、关于页制作</h3><p>在 source 目录下创建 about 文件夹，用于存放关于页。我只想简单写点信息，所以直接建了个 index.md 文件写了点东西，样式调整了一下。</p>
<h3 id="5、存档页制作"><a href="#5、存档页制作" class="headerlink" title="5、存档页制作"></a>5、存档页制作</h3><p>存档页相当于做了个文章的时间线，</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mixin articleSort(posts)</span><br><span class="line">  .article-sort</span><br><span class="line">    - <span class="keyword">var</span> year</span><br><span class="line">    - posts.each(<span class="function"><span class="keyword">function</span> (<span class="params">article</span>) </span>&#123;</span><br><span class="line">      - <span class="keyword">var</span> tempYear = date(article.date, <span class="string">'YYYY'</span>)</span><br><span class="line">      <span class="keyword">if</span> tempYear !== year</span><br><span class="line">        - year = tempYear</span><br><span class="line">        .article-item.year= year</span><br><span class="line">      .article-item</span><br><span class="line">        time.article-item__time= date(article.date)</span><br><span class="line">        a.article-item__title(href=url_for(article.path))= article.title || <span class="string">'No Title'</span></span><br><span class="line">    - &#125;)</span><br></pre></td></tr></table></figure>
<h3 id="6、标签页制作"><a href="#6、标签页制作" class="headerlink" title="6、标签页制作"></a>6、标签页制作</h3><p>主要利用 list_tags() 函数实现，在主页中做判断决定显示内容。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> page.type === <span class="string">'tags'</span></span><br><span class="line">  article#tag</span><br><span class="line">    h1.tag-title= <span class="string">'标签'</span></span><br><span class="line">    hr</span><br><span class="line">    .tag-cloud-tags!= list_tags()</span><br></pre></td></tr></table></figure>
<h2 id="五、发布"><a href="#五、发布" class="headerlink" title="五、发布"></a>五、发布</h2><p>在 Hexo 的官方 fork <a href="https://github.com/hexojs/site" target="_blank" rel="noopener">站点</a>，然后编辑<code>source/_data/theme.yml</code>文件，添加信息示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">- name: Yin</span><br><span class="line">  description: A simple &amp; beautiful &amp; fast theme for Hexo</span><br><span class="line">  link: https://github.com/Yin-Hongwei/hexo-theme-Yin</span><br><span class="line">  preview: https://yin-hongwei.github.io/</span><br><span class="line">  tags:</span><br><span class="line">    - simple</span><br><span class="line">    - beautiful</span><br><span class="line">    - fast</span><br></pre></td></tr></table></figure>
<p>在 <code>source/theme/screenshots/</code>文件夹里放置一张和你主题名字一样尺寸的图片，大小是800*500。</p>
<p>提交修改后的信息到自己fork的仓库里。最后向官方站点发起一个<code>pull request</code> 即可</p>
<div class="qr-code"></div><img class="qrcode-img" src="/img/weixin.jpg"><div class="qrcode-desc">微信打赏</div><div class="post-tag-list">标签: <a class="post-tags" href="/tags/Hexo/">Hexo</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2019/08/01/koa入门/"><i class="fa fa-chevron-left"></i><span>koa 入门</span></a></div><div class="next-post pull-right"><a href="/2018/12/06/vue数据获取/"><span>Vue 中有关数据获取问题</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="gitalk-container"></div><script>var gitalk = new Gitalk({
  clientID: 'e238e2d1f25ec6e15026',
  clientSecret: '3c4e537d46a59d056e6c0cc478b04784defafcfb',
  repo: 'Yin-Hongwei.github.io',
  owner: 'Yin-Hongwei',
  admin: 'Yin-Hongwei',
  id: md5(window.location.pathname)
})
gitalk.render('gitalk-container')</script></article></section></article><footer id="footer-outer"><div id="footer-inner"><p class="footer-text">Copyright &copy; 2018-2020</p><p class="footer-text">Designed by Yin-Hongwei</p></div></footer></body><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="/js/main.js" defer></script><script src="/js/scroll.js" defer></script></html>